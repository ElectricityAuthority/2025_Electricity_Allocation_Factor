GAMS 42.5.0  cf11b917 Mar 30, 2023          WEX-WEI x86 64bit/MS Windows - 06/06/25 14:56:49 Page 1
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


   1  *=====================================================================================
   2  * Name:                 runvSPD.gms
   3  * Function:             This file is invoked to control the entire operation of vSPD.
   4  * Developed by:         Electricity Authority, New Zealand
   5  * Source:               https://github.com/ElectricityAuthority/vSPD
   6  *                       https://www.emi.ea.govt.nz/Tools/vSPD
   7  * Contact:              Forum: https://www.emi.ea.govt.nz/forum/
   8  *                       Email: emi@ea.govt.nz
   9  * Last modified on:     1 Oct 2019
  10  *=====================================================================================
  11   
  12   
  19   
  20   
  21  *=====================================================================================
  22  *Include paths and settings files
  23  *=====================================================================================
INCLUDE    C:\GitHub\2025_Electricity_Allocation_Factor\Programs_Counter1\vSPDsettings.inc
  25  *+++ vSPD settings +++
  28   
  29  *+++ Paths +++
  31   
  36   
  38   
  39  *+++ Model +++
  40  Scalar sequentialSolve                   / 0 / ;   ! Vectorisation: Yes <-> i_SequentialSolve: 0
  41  Scalar dailymode                         / 1 / ;   ! Solving quickly by using RTD pre-calculated demand or PRSS solved initial MW
  42   
  43  *+++ Network +++
  44  Scalar useACLossModel                    / 1 /    ;
  45  Scalar useHVDCLossModel                  / 1 /    ;
  46  Scalar useACBranchLimits                 / 1 /    ;
  47  Scalar useHVDCBranchLimits               / 1 /    ;
  48  Scalar resolveCircularBranchFlows        / 1 /    ;
  49  Scalar resolveHVDCNonPhysicalLosses      / 1 /    ;
  50  Scalar resolveACNonPhysicalLosses        / 0 /    ;   ! Placeholder for future code development
  51  Scalar circularBranchFlowTolerance       / 1e-4 / ;
  52  Scalar nonPhysicalLossTolerance          / 1e-6 / ;
  53  Scalar useBranchFlowMIPTolerance         / 1e-6 / ;
  54   
  55  *+++ Constraints +++
  56  Scalar useReserveModel                   / 1 /    ;
  57  Scalar suppressMixedConstraint           / 0 /    ;   ! No longer used since Mixed MIP Constraints no longer exists
  58  Scalar mixedMIPtolerance                 / 1e-6 / ;   ! No longer used since Mixed MIP Constraints no longer exists
  59   
  60  *+++ Solver +++
  61  Scalar LPtimeLimit                       / 3600 / ;
  62  Scalar LPiterationLimit                  / 2000000000 / ;
  63  Scalar MIPtimeLimit                      / 3600 / ;
  64  Scalar MIPiterationLimit                 / 2000000000 / ;
  65  Scalar MIPoptimality                     / 0 / ;
  68   
  69   
  70  *+++ Various switches +++
  72   
  73   
  74  *=====================================================================================
  75  * Create a progress report file
  76  *=====================================================================================
  77  File rep "Write a progess report" /"ProgressReport.txt"/ ;  rep.lw = 0 ;
  78  putclose rep "Run: 'CounterFactual1_20250401'" //
  79               "runvSPD started at: " system.date " " system.time;
  80   
  81   
  82  *=====================================================================================
  83  * Define external files
  84  *=====================================================================================
  85  Files
  86  temp       "A temporary, recyclable batch file"
  87  vSPDcase   "The current input case file"      / "vSPDcase.inc" /;
  88  vSPDcase.lw = 0 ;   vSPDcase.sw = 0 ;
  89   
  90   
  91  *=====================================================================================
  92  * Install the set of input GDX file names over which the solve and reporting loops will operate
  93  *=====================================================================================
  95  Set i_fileName(*) 'Input GDX file names'
INCLUDE    C:\GitHub\2025_Electricity_Allocation_Factor\Programs_Counter1\vSPDfileList.inc
  97  /
  98  'Pricing_20250401'
  99  /
 100  ;
 102   
 103  *=====================================================================================
 104  * Compiling vSPDModel if required
 105  * Establish the output folders for the current job
 106  * Copy program codes for repeatability and reproducibility
 107  *=====================================================================================
 108  rep.ap = 1 ;
 109  putclose rep "vSPDsetup started at: " system.date " " system.time ;
 110   
 111  * Invoke vSPDmodel if license type is developer (licenseMode=1)
 114   
 115  execute 'if exist "C:/Simulations/EAF_2025/vSPD_5.0.5/Output/CounterFactual1_20250401" rmdir "C:/Simulations/EAF_2025/vSPD_5.0.5/Output/CounterFactual1_20250401" /s /q';
 116  execute 'if exist "C:\GitHub\2025_Electricity_Allocation_Factor\Programs_Counter1\lst"  rmdir "C:\GitHub\2025_Electricity_Allocation_Factor\Programs_Counter1\lst" /s /q';
 117  execute 'mkdir "C:\GitHub\2025_Electricity_Allocation_Factor\Programs_Counter1\lst"';
 118  execute 'mkdir "C:/Simulations/EAF_2025/vSPD_5.0.5/Output/CounterFactual1_20250401\Programs"';
 119  execute 'copy /y vSPD*.inc "C:/Simulations/EAF_2025/vSPD_5.0.5/Output/CounterFactual1_20250401\Programs"'
 120  execute 'copy /y *.gms "C:/Simulations/EAF_2025/vSPD_5.0.5/Output/CounterFactual1_20250401\Programs"'
 121  execute 'copy /y cplex.opt "C:/Simulations/EAF_2025/vSPD_5.0.5/Output/CounterFactual1_20250401\Programs"'
 122   
 124   
 127   
 128   
 129  *=====================================================================================
 130  * Initialize reports
 131  *=====================================================================================
 132  * Call vSPDreportSetup to establish the report files ready to write results into
 133  execute 'gams vSPDreportSetup.gms'
 135   
 136   
 137  *=====================================================================================
 138  * Solve vSPD and report - loop over the designated input GDX files and solve each one in turn.
 139  *=====================================================================================
 140  loop(i_fileName,
 141   
 142  *  Create the file that has the name of the input file for the current case being solved
 143     putclose vSPDcase "$setglobal  GDXname  " i_fileName.tl:0 ;
 144   
 145  *  Create a gdx file contains periods to be solved
 146     put_utility temp 'exec' / 'gams vSPDperiod' ;
 147   
 148  *  Solve the model for the current input file
 149     put_utility temp 'exec' / 'gams vSPDsolve.gms r=vSPDmodel lo=3 ide=1 Errmsg = 1 holdFixed = 0' ;
 150   
 151  *  Copy the vSPDsolve.lst file to i_fileName.lst in ..\Programs\lst\
 152     put_utility temp 'shell' / 'copy vSPDsolve.lst "C:\GitHub\2025_Electricity_Allocation_Factor\Programs_Counter1\"\lst\', i_fileName.tl:0, '.lst' ;
 153   
 154  ) ;
 155  rep.ap = 1 ;
 156  putclose rep / "Total execute time: " timeExec "(secs)" /;
 157   
 158   
 159  *=====================================================================================
 160  * Clean up
 161  *=====================================================================================
 163  *execute 'erase "vSPDcase.inc"' ;
 165  execute 'move /y ProgressReport.txt "C:/Simulations/EAF_2025/vSPD_5.0.5/Output/CounterFactual1_20250401"';
 167  *execute 'if exist *.lst   erase /q *.lst '
 168  *execute 'if exist *.~gm   erase /q *.~gm '
 169  *execute 'if exist *.lxi   erase /q *.lxi '
 170  *execute 'if exist *.log   erase /q *.log '
 171  *execute 'if exist *.put   erase /q *.put '
 172  *execute 'if exist *.txt   erase /q *.txt '
 173  **execute 'if exist *.gdx   erase /q *.gdx '
 174  *execute 'if exist temp.*  erase /q temp.*'
 175   
 176   
 177   
GAMS 42.5.0  cf11b917 Mar 30, 2023          WEX-WEI x86 64bit/MS Windows - 06/06/25 14:56:49 Page 2
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Include File Summary


   SEQ   GLOBAL TYPE      PARENT   LOCAL  FILENAME

     1        1 INPUT          0       0  C:\GitHub\2025_Electricity_Allocation_Factor\Programs_Counter1\runvSPD.gms
     2       13 CALL           1      13  cls
     3       24 INCLUDE        1      24  .C:\GitHub\2025_Electricity_Allocation_Factor\Programs_Counter1\vSPDsettings.inc
     4       96 INCLUDE        1      49  .C:\GitHub\2025_Electricity_Allocation_Factor\Programs_Counter1\vSPDfileList.inc
     5      112 CALL           1      62  gams vSPDmodel.gms s=vSPDmodel
     6      123 IF EXIST       1      73  C:\GitHub\2025_Electricity_Allocation_Factor\Override\.gdx


COMPILATION TIME     =        0.281 SECONDS      3 MB  42.5.0 cf11b917 WEX-WEI
GAMS 42.5.0  cf11b917 Mar 30, 2023          WEX-WEI x86 64bit/MS Windows - 06/06/25 14:56:49 Page 3
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
E x e c u t i o n


**** REPORT FILE SUMMARY

rep C:\GitHub\2025_Electricity_Allocation_Factor\Programs_Counter1\ProgressReport.txt
temp C:\GitHub\2025_Electricity_Allocation_Factor\Programs_Counter1\temp.put
vSPDcase C:\GitHub\2025_Electricity_Allocation_Factor\Programs_Counter1\vSPDcase.inc


EXECUTION TIME       =      765.531 SECONDS      4 MB  42.5.0 cf11b917 WEX-WEI


USER: Small MUD-5 User License                       G241108|0002CO-GEN
      Electricity Authority - Te Mana Hiko,                  DC5643-S12


**** FILE SUMMARY

Input      C:\GitHub\2025_Electricity_Allocation_Factor\Programs_Counter1\runvSPD.gms
Output     C:\GitHub\2025_Electricity_Allocation_Factor\Programs_Counter1\runvSPD.lst
