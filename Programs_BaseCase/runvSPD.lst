GAMS 42.5.0  cf11b917 Mar 30, 2023          WEX-WEI x86 64bit/MS Windows - 04/02/25 13:21:10 Page 1
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


   1  *=====================================================================================
   2  * Name:                 runvSPD.gms
   3  * Function:             This file is invoked to control the entire operation of vSPD.
   4  * Developed by:         Electricity Authority, New Zealand
   5  * Source:               https://github.com/ElectricityAuthority/vSPD
   6  *                       https://www.emi.ea.govt.nz/Tools/vSPD
   7  * Contact:              Forum: https://www.emi.ea.govt.nz/forum/
   8  *                       Email: emi@ea.govt.nz
   9  * Last modified on:     1 Oct 2019
  10  *=====================================================================================
  11   
  12   
  19   
  20   
  21  *=====================================================================================
  22  *Include paths and settings files
  23  *=====================================================================================
INCLUDE    C:\GitHub\2025_Electricity_Allocation_Factor\Programs_BaseCase\vSPDsettings.inc
  25  *+++ vSPD settings +++
  28   
  29  *+++ Paths +++
  31   
  36   
  38   
  39  *+++ Model +++
  40  Scalar sequentialSolve                   / 0 / ;   ! Vectorisation: Yes <-> i_SequentialSolve: 0
  41  Scalar dailymode                         / 1 / ;   ! Solving quickly by using RTD pre-calculated demand or PRSS solved initial MW
  42   
  43  *+++ Network +++
  44  Scalar useACLossModel                    / 1 /    ;
  45  Scalar useHVDCLossModel                  / 1 /    ;
  46  Scalar useACBranchLimits                 / 1 /    ;
  47  Scalar useHVDCBranchLimits               / 1 /    ;
  48  Scalar resolveCircularBranchFlows        / 1 /    ;
  49  Scalar resolveHVDCNonPhysicalLosses      / 1 /    ;
  50  Scalar resolveACNonPhysicalLosses        / 0 /    ;   ! Placeholder for future code development
  51  Scalar circularBranchFlowTolerance       / 1e-4 / ;
  52  Scalar nonPhysicalLossTolerance          / 1e-6 / ;
  53  Scalar useBranchFlowMIPTolerance         / 1e-6 / ;
  54   
  55  *+++ Constraints +++
  56  Scalar useReserveModel                   / 1 /    ;
  57  Scalar suppressMixedConstraint           / 0 /    ;   ! No longer used since Mixed MIP Constraints no longer exists
  58  Scalar mixedMIPtolerance                 / 1e-6 / ;   ! No longer used since Mixed MIP Constraints no longer exists
  59   
  60  *+++ Solver +++
  61  Scalar LPtimeLimit                       / 3600 / ;
  62  Scalar LPiterationLimit                  / 2000000000 / ;
  63  Scalar MIPtimeLimit                      / 3600 / ;
  64  Scalar MIPiterationLimit                 / 2000000000 / ;
  65  Scalar MIPoptimality                     / 0 / ;
  68   
  69   
  70  *+++ Various switches +++
  72   
  73   
  74  *=====================================================================================
  75  * Create a progress report file
  76  *=====================================================================================
  77  File rep "Write a progess report" /"ProgressReport.txt"/ ;  rep.lw = 0 ;
  78  putclose rep "Run: 'BaseCase_202410'" //
  79               "runvSPD started at: " system.date " " system.time;
  80   
  81   
  82  *=====================================================================================
  83  * Define external files
  84  *=====================================================================================
  85  Files
  86  temp       "A temporary, recyclable batch file"
  87  vSPDcase   "The current input case file"      / "vSPDcase.inc" /;
  88  vSPDcase.lw = 0 ;   vSPDcase.sw = 0 ;
  89   
  90   
  91  *=====================================================================================
  92  * Install the set of input GDX file names over which the solve and reporting loops will operate
  93  *=====================================================================================
  95  Set i_fileName(*) 'Input GDX file names'
INCLUDE    C:\GitHub\2025_Electricity_Allocation_Factor\Programs_BaseCase\vSPDfileList.inc
  97  /
  98  'Pricing_20241001'
  99  'Pricing_20241002'
 100  'Pricing_20241003'
 101  'Pricing_20241004'
 102  'Pricing_20241005'
 103  'Pricing_20241006'
 104  'Pricing_20241007'
 105  'Pricing_20241008'
 106  'Pricing_20241009'
 107  'Pricing_20241010'
 108  'Pricing_20241011'
 109  'Pricing_20241012'
 110  'Pricing_20241013'
 111  'Pricing_20241014'
 112  'Pricing_20241015'
 113  'Pricing_20241016'
 114  'Pricing_20241017'
 115  'Pricing_20241018'
 116  'Pricing_20241019'
 117  'Pricing_20241020'
 118  'Pricing_20241021'
 119  'Pricing_20241022'
 120  'Pricing_20241023'
 121  'Pricing_20241024'
 122  'Pricing_20241025'
 123  'Pricing_20241026'
 124  'Pricing_20241027'
 125  'Pricing_20241028'
 126  'Pricing_20241029'
 127  'Pricing_20241030'
 128  'Pricing_20241031'
 129  /
 130  ;
 132   
 133  *=====================================================================================
 134  * Compiling vSPDModel if required
 135  * Establish the output folders for the current job
 136  * Copy program codes for repeatability and reproducibility
 137  *=====================================================================================
 138  rep.ap = 1 ;
 139  putclose rep "vSPDsetup started at: " system.date " " system.time ;
 140   
 141  * Invoke vSPDmodel if license type is developer (licenseMode=1)
 144   
 145  execute 'if exist "C:\GitHub\2025_Electricity_Allocation_Factor\Programs_BaseCase\..\Output\BaseCase_202410" rmdir "C:\GitHub\2025_Electricity_Allocation_Factor\Programs_BaseCase\..\Output\BaseCase_202410" /s /q';
 146  execute 'if exist "C:\GitHub\2025_Electricity_Allocation_Factor\Programs_BaseCase\lst"  rmdir "C:\GitHub\2025_Electricity_Allocation_Factor\Programs_BaseCase\lst" /s /q';
 147  execute 'mkdir "C:\GitHub\2025_Electricity_Allocation_Factor\Programs_BaseCase\lst"';
 148  execute 'mkdir "C:\GitHub\2025_Electricity_Allocation_Factor\Programs_BaseCase\..\Output\BaseCase_202410\Programs"';
 149  execute 'copy /y vSPD*.inc "C:\GitHub\2025_Electricity_Allocation_Factor\Programs_BaseCase\..\Output\BaseCase_202410\Programs"'
 150  execute 'copy /y *.gms "C:\GitHub\2025_Electricity_Allocation_Factor\Programs_BaseCase\..\Output\BaseCase_202410\Programs"'
 151  execute 'copy /y cplex.opt "C:\GitHub\2025_Electricity_Allocation_Factor\Programs_BaseCase\..\Output\BaseCase_202410\Programs"'
 152   
 154   
 157   
 158   
 159  *=====================================================================================
 160  * Initialize reports
 161  *=====================================================================================
 162  * Call vSPDreportSetup to establish the report files ready to write results into
 163  execute 'gams vSPDreportSetup.gms'
 165   
 166   
 167  *=====================================================================================
 168  * Solve vSPD and report - loop over the designated input GDX files and solve each one in turn.
 169  *=====================================================================================
 170  loop(i_fileName,
 171   
 172  *  Create the file that has the name of the input file for the current case being solved
 173     putclose vSPDcase "$setglobal  GDXname  " i_fileName.tl:0 ;
 174   
 175  *  Create a gdx file contains periods to be solved
 176     put_utility temp 'exec' / 'gams vSPDperiod' ;
 177   
 178  *  Solve the model for the current input file
 179     put_utility temp 'exec' / 'gams vSPDsolve.gms r=vSPDmodel lo=3 ide=1 Errmsg = 1 holdFixed = 0' ;
 180   
 181  *  Copy the vSPDsolve.lst file to i_fileName.lst in ..\Programs\lst\
 182     put_utility temp 'shell' / 'copy vSPDsolve.lst "C:\GitHub\2025_Electricity_Allocation_Factor\Programs_BaseCase\"\lst\', i_fileName.tl:0, '.lst' ;
 183   
 184  ) ;
 185  rep.ap = 1 ;
 186  putclose rep / "Total execute time: " timeExec "(secs)" /;
 187   
 188   
 189  *=====================================================================================
 190  *