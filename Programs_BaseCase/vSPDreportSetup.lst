GAMS 42.5.0  cf11b917 Mar 30, 2023          WEX-WEI x86 64bit/MS Windows - 06/06/25 10:51:08 Page 1
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


   1  *===============================================================================
   2  * Name:                 vSPDreportSetup.gms
   3  * Function:             Creates the report templates for normal SPD run
   4  * Developed by:         Tuong Nguyen - Electricity Authority, New Zealand
   5  * Source:               https://github.com/ElectricityAuthority/vSPD
   6  *                       https://www.emi.ea.govt.nz/Tools/vSPD
   7  * Contact:              Forum: https://www.emi.ea.govt.nz/forum/
   8  *                       Email: emi@ea.govt.nz
   9  * Last modified on:     1 Oct 2019
  10  * Last modified on:     08 August 2023
  11  *                       add Period to report
  12  *===============================================================================
  13   
INCLUDE    C:\GitHub\2025_Electricity_Allocation_Factor\Programs_BaseCase\vSPDsettings.inc
  15  *+++ vSPD settings +++
  18   
  19  *+++ Paths +++
  21   
  26   
  28   
  29  *+++ Model +++
  30  Scalar sequentialSolve                   / 0 / ;   ! Vectorisation: Yes <-> i_SequentialSolve: 0
  31  Scalar dailymode                         / 1 / ;   ! Solving quickly by using RTD pre-calculated demand or PRSS solved initial MW
  32   
  33  *+++ Network +++
  34  Scalar useACLossModel                    / 1 /    ;
  35  Scalar useHVDCLossModel                  / 1 /    ;
  36  Scalar useACBranchLimits                 / 1 /    ;
  37  Scalar useHVDCBranchLimits               / 1 /    ;
  38  Scalar resolveCircularBranchFlows        / 1 /    ;
  39  Scalar resolveHVDCNonPhysicalLosses      / 1 /    ;
  40  Scalar resolveACNonPhysicalLosses        / 0 /    ;   ! Placeholder for future code development
  41  Scalar circularBranchFlowTolerance       / 1e-4 / ;
  42  Scalar nonPhysicalLossTolerance          / 1e-6 / ;
  43  Scalar useBranchFlowMIPTolerance         / 1e-6 / ;
  44   
  45  *+++ Constraints +++
  46  Scalar useReserveModel                   / 1 /    ;
  47  Scalar suppressMixedConstraint           / 0 /    ;   ! No longer used since Mixed MIP Constraints no longer exists
  48  Scalar mixedMIPtolerance                 / 1e-6 / ;   ! No longer used since Mixed MIP Constraints no longer exists
  49   
  50  *+++ Solver +++
  51  Scalar LPtimeLimit                       / 3600 / ;
  52  Scalar LPiterationLimit                  / 2000000000 / ;
  53  Scalar MIPtimeLimit                      / 3600 / ;
  54  Scalar MIPiterationLimit                 / 2000000000 / ;
  55  Scalar MIPoptimality                     / 0 / ;
  58   
  59   
  60  *+++ Various switches +++
  62   
  63  File rep "Write a progess report" /"ProgressReport.txt"/ ;
  64  rep.lw = 0 ; rep.ap = 1 ;
  65  putclose rep "vSPDreportSetup started at: " system.date " " system.time /;
  66   
  67  * Trade Period Reports *********************************************************
  68  File summaryResults_TP   / "C:/Simulations/EAF_2025/vSPD_5.0.5/Output/\BaseCase_20250401\BaseCase_20250401_SummaryResults_TP.csv" /;
  69  summaryResults_TP.pc = 5; summaryResults_TP.lw = 0; summaryResults_TP.pw = 9999;
  70  put summaryResults_TP 'CaseID','DateTime','Period','SolveStatus (1=OK)', 'SystemOFV','SystemCost', 'SystemBenefit', 'ViolationCost','DeficitGenViol (MW)', 'SurplusGenViol (MW)', 'DeficitReserveViol (MW)','SurplusBranchFlowViol (MW)'
  71      'DeficitRampRateViol (MW)','SurplusRampRateViol (MW)', 'DeficitBranchGroupConstraintViol (MW)','SurplusBranchGroupConstraintViol (MW)', 'DeficitMNodeConstraintViol (MW)', 'SurplusMNodeConstraintViol (MW)';
  72   
  73  File islandResults_TP    / "C:/Simulations/EAF_2025/vSPD_5.0.5/Output/\BaseCase_20250401\BaseCase_20250401_IslandResults_TP.csv" /;
  74  islandResults_TP.pc = 5; islandResults_TP.lw = 0; islandResults_TP.pw = 9999;
  75  put islandResults_TP 'CaseID','DateTime','Period', 'Island', 'Gen (MW)', 'Load (MW)', 'Bid Load (MW)', 'IslandACLoss (MW)', 'HVDCFlow (MW)', 'HVDCLoss (MW)'
  76      'ReferencePrice ($/MWh)', 'FIR_req (MW)', 'SIR_req (MW)','FIR Price ($/MWh)', 'SIR Price ($/MWh)'
  77      'FIR_Clear', 'SIR_Clear', 'FIR_Share', 'SIR_Share','FIR_Receive', 'SIR_Receive', 'FIR_Effective_CE', 'SIR_Effective_CE', 'FIR_Effective_ECE', 'SIR_Effective_ECE' ;
  78   
  79  File busResults_TP       / "C:/Simulations/EAF_2025/vSPD_5.0.5/Output/\BaseCase_20250401\BaseCase_20250401_BusResults_TP.csv" /;
  80  busResults_TP.pc = 5; busResults_TP.lw = 0; busResults_TP.pw = 9999;
  81  put busResults_TP 'CaseID','DateTime','Period', 'Bus', 'Generation (MW)', 'Load (MW)','Price ($/MWh)', 'Deficit(MW)', 'Surplus(MW)';
  82   
  83  File nodeResults_TP      / "C:/Simulations/EAF_2025/vSPD_5.0.5/Output/\BaseCase_20250401\BaseCase_20250401_NodeResults_TP.csv" /;
  84  nodeResults_TP.pc = 5; nodeResults_TP.lw = 0; nodeResults_TP.pw = 9999;
  85  put nodeResults_TP 'CaseID','DateTime','Period', 'Node','Generation (MW)','Load (MW)','Price ($/MWh)','Deficit(MW)', 'Surplus(MW)';
  86   
  87  File PublishedEnergyPrices_TP /"C:/Simulations/EAF_2025/vSPD_5.0.5/Output/\BaseCase_20250401\BaseCase_20250401_PublishedEnergyPrices_TP.csv"/;
  88  PublishedEnergyPrices_TP.pc = 5 ; PublishedEnergyPrices_TP.lw = 0 ; PublishedEnergyPrices_TP.pw = 9999 ;
  89  put PublishedEnergyPrices_TP 'DateTime','TradingPeriod','Pnodename','vSPDDollarsPerMegawattHour';
  90   
  91  File PublishedReservePrices_TP /"C:/Simulations/EAF_2025/vSPD_5.0.5/Output/\BaseCase_20250401\BaseCase_20250401_PublishedReservePrices_TP.csv"/;
  92  PublishedReservePrices_TP.pc = 5 ; PublishedReservePrices_TP.lw = 0 ; PublishedReservePrices_TP.pw = 9999 ;
  93  put PublishedReservePrices_TP 'DateTime','TradingPeriod','Island','vSPDFIRDollarsPerMegawattHour','vSPDSIRDollarsPerMegawattHour';
  94   
  95  File offerResults_TP     / "C:/Simulations/EAF_2025/vSPD_5.0.5/Output/\BaseCase_20250401\BaseCase_20250401_OfferResults_TP.csv" /;
  96  offerResults_TP.pc = 5; offerResults_TP.lw = 0; offerResults_TP.pw = 9999;
  97  put offerResults_TP 'CaseID','DateTime','Period','Offer','Trader','Generation (MW)','FIR (MW)','SIR (MW)' ;
  98   
  99  File bidResults_TP       / "C:/Simulations/EAF_2025/vSPD_5.0.5/Output/\BaseCase_20250401\BaseCase_20250401_BidResults_TP.csv" /;
 100  bidResults_TP.pc = 5; bidResults_TP.lw = 0; bidResults_TP.pw = 9999;
 101  put bidResults_TP 'CaseID','DateTime','Period', 'Bid', 'Trader','Total Bid (MW)', 'Cleared Bid (MW)' ;
 102   
 103  File reserveResults_TP   / "C:/Simulations/EAF_2025/vSPD_5.0.5/Output/\BaseCase_20250401\BaseCase_20250401_ReserveResults_TP.csv" /;
 104  reserveResults_TP.pc = 5; reserveResults_TP.lw = 0; reserveResults_TP.pw = 9999;
 105  put reserveResults_TP 'CaseID','DateTime','Period', 'Island', 'FIR Reqd (MW)', 'SIR Reqd (MW)','FIR Price ($/MW)', 'SIR Price ($/MW)', 'FIR Violation (MW)', 'SIR Violation (MW)' ;
 106   
 107  File riskResults_TP   / "C:/Simulations/EAF_2025/vSPD_5.0.5/Output/\BaseCase_20250401\BaseCase_20250401_RiskResults_TP.csv" /;
 108  riskResults_TP.pc = 5; riskResults_TP.lw = 0; riskResults_TP.pw = 9999;
 109  put riskResults_TP 'CaseID','DateTime','Period', 'Island', 'ReserveClass', 'RiskClass','RiskType','RiskSetter','CoveredEnergy','CoveredReserve','CoveredFKBand','RiskSubtractor','Reserve','Shortfall','Deficit','ReservePrice','RiskPrice';
 110   
 111  File branchResults_TP    / "C:/Simulations/EAF_2025/vSPD_5.0.5/Output/\BaseCase_20250401\BaseCase_20250401_BranchResults_TP.csv" /;
 112  branchResults_TP.pc = 5; branchResults_TP.lw = 0; branchResults_TP.pw = 9999;
 113  put branchResults_TP 'CaseID','DateTime','Period', 'Branch', 'FromBus', 'ToBus','Flow (MW) (From->To)', 'Capacity (MW)', 'DynamicLoss (MW)','FixedLoss (MW)', 'FromBusPrice ($/MWh)', 'ToBusPrice ($/MWh)', 'BranchPrice ($/MWh)', 'BranchRentals ($)' ;
 114   
 115  File brCstrResults_TP    / "C:/Simulations/EAF_2025/vSPD_5.0.5/Output/\BaseCase_20250401\BaseCase_20250401_BrConstraintResults_TP.csv" /;
 116  brCstrResults_TP.pc = 5; brCstrResults_TP.lw = 0; brCstrResults_TP.pw = 9999;
 117  put brCstrResults_TP 'CaseID','DateTime','Period', 'BranchConstraint', 'LHS (MW)','Sense (-1:<=, 0:=, 1:>=)', 'RHS (MW)', 'Price ($/MWh)' ;
 118   
 119  File MNodeCstrResults_TP / "C:/Simulations/EAF_2025/vSPD_5.0.5/Output/\BaseCase_20250401\BaseCase_20250401_MNodeConstraintResults_TP.csv" /;
 120  MNodeCstrResults_TP.pc = 5; MNodeCstrResults_TP.lw = 0; MNodeCstrResults_TP.pw = 9999 ;
 121  put MNodeCstrResults_TP 'CaseID','DateTime','Period', 'MNodeConstraint', 'LHS (MW)','Sense (-1:<=, 0:=, 1:>=)', 'RHS (MW)', 'Price ($/MWh)' ;
 122   
 123  File EnergyOffers_TP / "C:/Simulations/EAF_2025/vSPD_5.0.5/Output/\BaseCase_20250401\BaseCase_20250401_EnergyOffers_TP.csv" /;
 124  EnergyOffers_TP.pc = 5; EnergyOffers_TP.lw = 0; EnergyOffers_TP.pw = 9999 ;
 125  put EnergyOffers_TP 'CaseID','DateTime','Period', 'Offer', 'Tranche', 'Megawatts','DollarsPerMegawattHour' ;
 126   
 127  *===============================================================================
 128  * Audit mode reporting process
 129  *===============================================================================
 131   
GAMS 42.5.0  cf11b917 Mar 30, 2023          WEX-WEI x86 64bit/MS Windows - 06/06/25 10:51:08 Page 2
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Include File Summary


   SEQ   GLOBAL TYPE      PARENT   LOCAL  FILENAME

     1        1 INPUT          0       0  C:\GitHub\2025_Electricity_Allocation_Factor\Programs_BaseCase\vSPDreportSetup.gms
     2       14 INCLUDE        1      14  .C:\GitHub\2025_Electricity_Allocation_Factor\Programs_BaseCase\vSPDsettings.inc


COMPILATION TIME     =        0.000 SECONDS      2 MB  42.5.0 cf11b917 WEX-WEI
GAMS 42.5.0  cf11b917 Mar 30, 2023          WEX-WEI x86 64bit/MS Windows - 06/06/25 10:51:08 Page 3
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
E x e c u t i o n


**** REPORT FILE SUMMARY

rep C:\GitHub\2025_Electricity_Allocation_Factor\Programs_BaseCase\ProgressReport.txt
summaryResults_TP C:\Simulations\EAF_2025\vSPD_5.0.5\Output\BaseCase_20250401\BaseCase_20250401_SummaryResults_TP.csv
islandResults_TP C:\Simulations\EAF_2025\vSPD_5.0.5\Output\BaseCase_20250401\BaseCase_20250401_IslandResults_TP.csv
busResults_TP C:\Simulations\EAF_2025\vSPD_5.0.5\Output\BaseCase_20250401\BaseCase_20250401_BusResults_TP.csv
nodeResults_TP C:\Simulations\EAF_2025\vSPD_5.0.5\Output\BaseCase_20250401\BaseCase_20250401_NodeResults_TP.csv
PublishedEnergyPrices_TP C:\Simulations\EAF_2025\vSPD_5.0.5\Output\BaseCase_20250401\BaseCase_20250401_PublishedEnergyPrices_TP.csv
PublishedReservePrices_TP C:\Simulations\EAF_2025\vSPD_5.0.5\Output\BaseCase_20250401\BaseCase_20250401_PublishedReservePrices_TP.csv
offerResults_TP C:\Simulations\EAF_2025\vSPD_5.0.5\Output\BaseCase_20250401\BaseCase_20250401_OfferResults_TP.csv
bidResults_TP C:\Simulations\EAF_2025\vSPD_5.0.5\Output\BaseCase_20250401\BaseCase_20250401_BidResults_TP.csv
reserveResults_TP C:\Simulations\EAF_2025\vSPD_5.0.5\Output\BaseCase_20250401\BaseCase_20250401_ReserveResults_TP.csv
riskResults_TP C:\Simulations\EAF_2025\vSPD_5.0.5\Output\BaseCase_20250401\BaseCase_20250401_RiskResults_TP.csv
branchResults_TP C:\Simulations\EAF_2025\vSPD_5.0.5\Output\BaseCase_20250401\BaseCase_20250401_BranchResults_TP.csv
brCstrResults_TP C:\Simulations\EAF_2025\vSPD_5.0.5\Output\BaseCase_20250401\BaseCase_20250401_BrConstraintResults_TP.csv
MNodeCstrResults_TP C:\Simulations\EAF_2025\vSPD_5.0.5\Output\BaseCase_20250401\BaseCase_20250401_MNodeConstraintResults_TP.csv
EnergyOffers_TP C:\Simulations\EAF_2025\vSPD_5.0.5\Output\BaseCase_20250401\BaseCase_20250401_EnergyOffers_TP.csv


EXECUTION TIME       =        0.000 SECONDS      3 MB  42.5.0 cf11b917 WEX-WEI


USER: Small MUD-5 User License                       G241108|0002CO-GEN
      Electricity Authority - Te Mana Hiko,                  DC5643-S12


**** FILE SUMMARY

Input      C:\GitHub\2025_Electricity_Allocation_Factor\Programs_BaseCase\vSPDreportSetup.gms
Output     C:\GitHub\2025_Electricity_Allocation_Factor\Programs_BaseCase\vSPDreportSetup.lst
